{% extends "timber_dashboard.html" %}
{% load static %}

{% block leftbutton %}
<ul class="nav nav-pills">

    {% if m_wew %}
        <li {% if mag1 %} class="active" {% endif %}><a href="{% url 'timber_list' mag='mag1' fl=fl %}">MAGAZYN SZPARAGOWA</a></li>
        <li {% if mag2 %} class="active" {% endif %}><a href="{% url 'timber_list' mag='mag2' fl=fl %}">MAGAZYN PROFILI</a></li>
        <li {% if mag3 %} class="active" {% endif %}><a href="{% url 'timber_list' mag='mag3' fl=fl %}">MAGAZYN CHEMII</a></li>
        <li {% if mag4 %} class="active" {% endif %}><a href="{% url 'timber_list' mag='mag4' fl=fl %}">MAGAZYN SZKŁA</a></li>
        <li {% if mag5 %} class="active" {% endif %}><a href="{% url 'timber_list' mag='mag5' fl=fl %}">MAGAZYN STALI</a></li>
    {% else %}
        <li {% if mag1 %} class="active" {% endif %}><a href="{% url 'timber_list' mag='mag1' fl=fl %}">MAGAZYN SZPARAGOWA</a></li>
        <li {% if mag2 %} class="active" {% endif %}><a href="{% url 'timber_list' mag='mag2' fl=fl %}">MAGAZYN PODOLANY</a></li>
        <li {% if mag3 %} class="active" {% endif %}><a href="{% url 'timber_list' mag='mag3' fl=fl %}">MAGAZYN U DOSTAWCY</a></li>
    {% endif %}
</ul>
{% endblock %}


{% block retbutton %}
{% if fls %}

            <li class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="adt1">
                    <i class="fa fa-money fa-fw"></i>
                    Ksiegowość
                    <i class="fa fa-caret-down"></i>
                </a>
                <ul class="dropdown-menu dropdown-user">
<!--                    <li>-->
<!--                        <a href="{% url 'timber_sda' rk=2024 mag=mag fl=fl %}"><font color="brown"><i class="fa fa-pie-chart fa-fw"></i></font> SDA wyszukiwanie [2024]</a>-->
<!--                    </li>-->
<!--                    <li class="divider"></li>-->
<!--                    <li>-->
<!--                        <a href="{% url 'timber_stat' rk=2024  mag=mag fl=fl %}"><font color="brown"><i class="fa fa-line-chart fa-fw"></i></font> SDA Statystyka [2024]</a>-->
<!--                    </li>-->
                    <li>
                        <a href="{% url 'export_all' rok=2024  mag=mag fl='0' %}"><font color="brown"><i class="fa fa-pie-chart fa-fw"></i></font>   Zestawienie całości do 31-12-2024 [xls]</a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="{% url 'export_all' rok=2023  mag=mag fl='1' %}"><font color="brown"><i class="fa fa-area-chart fa-fw"></i></font>   Zestawienie za 2023 [xls]</a>
                    </li>
                    <li>
                        <a href="{% url 'export_all' rok=2024  mag=mag fl='2' %}"><font color="brown"><i class="fa fa-area-chart fa-fw"></i></font>   Zestawienie za 2024 [xls]</a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="#" data-toggle="modal" data-target="#GEN_RAP">
                            <font color="brown"><i class="fa fa-area-chart fa-fw"></i></font> Zestawienie z datami [xls]
                        </a>
                    </li>

                    <li class="divider"></li>
<!--                    <li>-->
<!--                        <a href="{% url 'timber_inwentura' rk=2024  mag=mag fl=fl %}"><font color="brown"><i class="fa fa-area-chart fa-fw"></i></font> [<font color="blue"><strong>{{ idata }}</strong></font>] Inwentura</a>-->
<!--                    </li>-->
                    <li>
                        <a href="{% url 'timber_inwentura' rk=2024  mag=mag fl=fl %}"><font color="brown"><i class="fa fa-area-chart fa-fw"></i></font> Inwentura</a>
                    </li>
<!--                    <li class="divider"></li>-->
<!--                    <li>-->
<!--                        <a href="{% url 'inw_pdf_data' rk=2023 mag='mag1' fl='dre' dt='2023-12-31' %}"><font color="brown"><i class="fa fa-area-chart fa-fw"></i></font> [<font color="blue"><strong>2023-12-31</strong></font>] Inwentura Szparagowa</a>-->
<!--                    </li>-->
<!--                    <li>-->
<!--                        <a href="{% url 'inw_pdf_data' rk=2023 mag='mag2' fl='dre' dt='2023-12-31' %}"><font color="brown"><i class="fa fa-area-chart fa-fw"></i></font> [<font color="blue"><strong>2023-12-31</strong></font>] Inwentura Podolany</a>-->
<!--                    </li>-->
<!--                    <li class="divider"></li>-->


<!--                    <li>-->
<!--                        <a href="{% url 'inw_pdf_data' rk=2023 mag='mag1' fl='dre' dt='2023-06-30' %}"><font color="brown"><i class="fa fa-area-chart fa-fw"></i></font> [<font color="blue"><strong>2023-06-30</strong></font>] Inwentura Szparagowa</a>-->
<!--                    </li>-->
<!--                    <li>-->
<!--                        <a href="{% url 'inw_pdf_data' rk=2023 mag='mag2' fl='dre' dt='2023-06-30' %}"><font color="brown"><i class="fa fa-area-chart fa-fw"></i></font> [<font color="blue"><strong>2023-06-30</strong></font>] Inwentura Podolany</a>-->
<!--                    </li>-->
                </ul>
                <!-- /.dropdown-user -->
            </li>

{% endif %}
<li>
    <a href="{% static 'DOCUMENTATION/modul_magazyn.pdf' %}" class=" btn btn-primary" target="_blank" style="color:white;">
                                            <i class="fa fa-exclamation-triangle" style="color:yellow;"></i>
                                            <strong>  Instrukcja</strong>
                                        </a>
</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
<li>
    <a class="btn btn-primary" href="{% url 'desktop' %}" id="pulpit"><font color="white"><i class="fa fa-dashboard fa-fw"></i> Pulpit</font></a>
</li>
{% endblock %}

{% block userlog %}
                {{ name_log }}
{% endblock %}


{% block title %}
<br><br>
{% endblock %}

{% block logo %}
{% endblock %}

{% block leftmenu %}
{% endblock %}

{% block style %}
            a:link.dt, a:visited.dt {
                     text-decoration: none;
            }
            a:hover.dt, a:active.dt {
                     text-decoration: none;
                     display: inline-block;
            }


            #wpz {
                color: brown;
                font-weight: bold;
            }
            #wrz {
                color: #a9a9a9;
            }

            .verticalText{
                text-align: center;
                vertical-align: middle;
                -webkit-transform: rotate(90deg);
                -moz-transform: rotate(90deg);
            }

            #panel_glowny {
<!--                    border-color: #5cb85c;-->
<!--                    color: white;-->
<!--                    background-color: #8cf88c;-->
            }
            #panel_naglowek {
                background-color: #6cd86c;
            }


            .nav-pills>li.active>a, .nav-pills>li.active>a:focus {
                color: #fff;
                background-color: #d43f3a;
            }
            .nav-pills>li.active>a:hover {
                color: #fff;
                background-color: #595959;
                border-color: #595959;
            }

            .nav-pills>li>a {
                color: #fff;
                background-color: #a5a5a5;
            }
            .nav-pills>li>a:hover {
                color: #fff;
                background-color: #595959;
                border-color: #595959;
            }

            #l_zest:link, #l_zest:visited {
                 color: brown;
            }
            #l_zest:hover {
                 color: red;
            }

            #l_ed:link, #l_ed:visited {
                 color: #6C3483;
            }
            #l_ed:hover {
                 color: #4A235A;
            }
            .table > tbody > tr:hover {
                        background-color: #f5f5f5;
            }
            #pulpit:hover {
                 background-color: gray;
            }

            #belka > ul.nav.navbar-top-links.navbar-right > li:nth-child(2) > a:hover {
                color: #fff;
                background-color: #595959;
                border-color: #595959;
            }

            #belka > ul.nav.navbar-top-links.navbar-right > li:nth-child(3) > a:hover {
                color: #fff;
                background-color: #595959;
                border-color: #595959;
            }

            #belka > ul.nav.navbar-top-links.navbar-right > li.dropdown.open > ul > a {
                color:brown;
                text-decoration: none;
            }

<!--            #belka > ul.nav.navbar-top-links.navbar-right > li:nth-child(1) > a {-->
<!--                color: #fff;-->
<!--                background-color: #BA5555;-->
<!--                border-color: #BA5555;-->
<!--            }-->

<!--            #belka > ul.nav.navbar-top-links.navbar-right > li:nth-child(1) > a:hover {-->
<!--                color: #fff;-->
<!--                background-color: #595959;-->
<!--                border-color: #595959;-->
<!--            }-->
            .panel-green > .panel-heading {
                border-color: #5cb85c;
                color: white;
                background-color: #999999;
            }
            .panel-green {
                border-color: #999999;
            }
{% endblock %}


{% block content %}


                <div class="col-lg-12">
                    <div class="panel panel-green" style="box-shadow: rgba(0, 0, 0, 0.07) 0px 1px 2px, rgba(0, 0, 0, 0.07) 0px 2px 4px, rgba(0, 0, 0, 0.07) 0px 4px 8px, rgba(0, 0, 0, 0.07) 0px 8px 16px, rgba(0, 0, 0, 0.07) 0px 16px 32px, rgba(0, 0, 0, 0.07) 0px 32px 64px;">
                        <div class="panel-heading">
                            <table width="100%">
                                <tr>
                                    <td width="250px" style="background-color: #5cb85c; border-right:1pt solid #F3F3F3;">
                                        <form metod="GET" action="{% url 'timber_list' mag=mag fl=fl %}">
                                            {% csrf_token %}
                                            <div class="input-group custom-search-form" style="box-shadow: rgba(0, 0, 0, 0.07) 0px 1px 2px, rgba(0, 0, 0, 0.07) 0px 2px 4px, rgba(0, 0, 0, 0.07) 0px 4px 8px, rgba(0, 0, 0, 0.07) 0px 8px 16px, rgba(0, 0, 0, 0.07) 0px 16px 32px, rgba(0, 0, 0, 0.07) 0px 32px 64px;">
                                                <input type="text" name="SZUKAJ" class="form-control" placeholder="Szukaj...">
                                                <span class="input-group-btn">
                                                    <button class="btn btn-default" type="submit"><i class="fa fa-search"></i></button>
                                                </span>
                                            </div>
                                        </form>
                                    </td>
                                    <td style="text-align:center;">
                                        {% if sw %}
                                            <font style="font-size:18px;"><strong>{{ title }}</strong></font>
                                             [ <font style="font-size:12px;"><strong>{{ opis }}</strong></font> ]
                                        {% else %}
                                            <font style="font-size:18px;"><strong>{{ title }}</strong></font>
                                        {% endif %}
                                    </td>

                                        {% if fmag %}
                                          {% if rw %}
                                            <td width="10px">&nbsp;</td>
                                             <td width="100px">
                                               <a href="{% url 'timber_add' mag=mag fl=fl %}" class="primary btn btn-default"  style="box-shadow: rgba(0, 0, 0, 0.07) 0px 1px 2px, rgba(0, 0, 0, 0.07) 0px 2px 4px, rgba(0, 0, 0, 0.07) 0px 4px 8px, rgba(0, 0, 0, 0.07) 0px 8px 16px, rgba(0, 0, 0, 0.07) 0px 16px 32px, rgba(0, 0, 0, 0.07) 0px 32px 64px;">&nbsp;<strong>Dodawanie nowego towaru</strong> </a>
                                             </td>
                                          {% endif %}
                                        {% endif %}

                                </tr>
                            </table>
                        </div>
                        <div class="panel-body">

                            <table width="100%" class="table  table-bordered table-condensed">
                                <thead>
                                <tr height="70px">
                                    <th style="background-color: #90867c; vertical-align:middle; text-align:center;color:#FFFACD; padding: 1px;">ID</th>
                                    <th style="background-color: #90867c; vertical-align:middle; text-align:center;color:#FFFACD; padding: 1px;">Nazwa</th>
                                    <th style="background-color: #90867c; vertical-align:middle; text-align:center;color:#FFFACD; padding: 1px;">Opis</th>
                                    <th style="background-color: #90867c; vertical-align:middle; text-align:center;color:#FFFACD; padding: 1px;" colspan="2">Stan</th>
                                    <th style="background-color: #90867c; vertical-align:middle; text-align:center;color:#FFFACD; padding: 1px;" colspan="2">
                                        <div class="verticalText">Operacje</div>
                                    </th>
                                    <th style="background-color: #90867c; vertical-align:middle; text-align:center;color:#FFFACD; padding: 1px;" width="20">
                                        <div class="verticalText">Historia</div>
                                    </th>
                                    <th style="background-color: #90867c; vertical-align:middle; text-align:center;color:#FFFACD; padding: 1px;" colspan="2">Inwentura<br>z natury</th>
                                    <th style="background-color: #90867c; vertical-align:middle; text-align:center;color:#FFFACD; padding: 1px;" width="20">
                                        <div class="verticalText">Edycja</div>
                                    </th>

                                </tr>

                                </thead>

                                  <tbody>
                                     {% for t in timber %}
                                     <tr>
                                         <td style="vertical-align:middle; text-align:center; font-weight: bold;width:40px;color:grey;">{{ t.prod_id }}</td>
                                         <td style="vertical-align:middle; text-align:center; font-weight: bold; width:20%;">{{ t.nazwa }}</td>
                                         <td style="vertical-align:middle; text-align:center;">{{ t.opis }}</td>
                                         {% if t.stan > t.limit %}
                                            <td style="vertical-align:middle; text-align:center; width:5%;">
                                         {% elif t.stan > zero %}
                                            <td style="vertical-align:middle; text-align:center; width:5%; color:white; font-weight:bold; background-color: #FFA500;">
                                         {% elif t.stan == zero %}
                                            <td style="vertical-align:middle; text-align:center; width:5%; color:white; font-weight:bold; background-color: #FFA500;">
                                         {% elif t.stan < zero %}
                                            <td style="vertical-align:middle; text-align:center; width:5%; color:white; font-weight:bold; background-color: #FF4500;">
                                         {% endif %}
                                            {{ t.stan }}</td>

                                         <td style="vertical-align:middle; text-align:center; width:40px;">{{ t.jm }}</td>
                                         <td style="vertical-align:middle; text-align:center;"  width="30">
                                             <a href="{% url 'rozchod_list' pk=t.id mag=mag fl=fl %}" data-toggle="tooltip" data-html="true" title="Rozchód towaru...">
                                                 <span class="glyphicon glyphicon-minus-sign" aria-hidden="true"></span>
                                             </a>
                                         </td>
                                         <td style="vertical-align:middle; text-align:center;" width="30">
                                             <a href="{% url 'przychod_list' pk=t.id mag=mag fl=fl %}" data-toggle="tooltip" data-html="true" title="Przyjęcie towaru...">
                                                 <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span>
                                             </a>
                                         </td>
                                         <!--<td style="vertical-align:middle; text-align:center;" width="30">
                                             <a href="{% url 'zwrot_list' pk=t.id mag=mag fl=fl %}" data-toggle="tooltip" data-html="true" title="Zwroty towaru...">
                                                 <span class="glyphicon glyphicon-import" aria-hidden="true"></span>
                                             </a>
                                         </td>-->
                                         <!-- <td style="vertical-align:middle; text-align:center;">{{ t.opis }}</td> -->
                                         <td style="vertical-align:middle; text-align:center;">
                                             <a id="l_zest" href="{% url 'zestawienie' pk=t.id mag=mag fl=fl sel='ze' %}">
                                                 <i class="fa fa-object-ungroup fa-fw"></i> <!-- fa fa-pie-chart  -->
                                             </a>
                                         </td>
                                         <td style="vertical-align:middle; text-align:center;color:gray;font-weight:bold;" width="70">
                                             {{ t.inw_stan }}
                                         </td>
                                         <td style="vertical-align:middle; text-align:center;color:gray;" width="100">
                                             {{ t.inw_data | date:'d-m-Y' }}
                                         </td>
                                         <td style="vertical-align:middle; text-align:center;">
                                             {% if fmag %}
                                               {% if rw %}
                                                 <a id="l_ed" href="{% url 'timber_edit' pk=t.id mag=mag fl=fl %}">
                                                     <i class="fa fa-pencil-square-o fa-fw"></i>
                                                 </a>
                                               {% endif %}
                                             {% endif %}
                                         </td>
                                     </tr>
                                     {% endfor %}
                                  </tbody>


                            </table>

                        </div>
                        <div class="panel-footer">
                        </div>
                    </div>

<!-- Okno modalne -->
<!--<div class="modal fade" id="dateModalG" tabindex="-1" role="dialog" aria-labelledby="dateModalLabel" aria-hidden="true">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <div class="modal-header">-->
<!--                <button type="button" class="close" data-dismiss="modal" aria-label="Close">-->
<!--                    <span aria-hidden="true">&times;</span>-->
<!--                </button>-->
<!--                <h4 class="modal-title" id="dateModalLabel">Wybierz zakres dat</h4>-->
<!--            </div>-->
<!--            <div class="modal-body">-->
<!--                <form id="dateForm">-->
<!--                    <div class="form-group">-->
<!--                        <label for="data_start" class="control-label">Data początkowa:</label>-->
<!--                        <input type="date" class="form-control" id="data_start" name="data_start" required>-->
<!--                    </div>-->
<!--                    <div class="form-group">-->
<!--                        <label for="data_stop" class="control-label">Data końcowa:</label>-->
<!--                        <input type="date" class="form-control" id="data_stop" name="data_stop" required>-->
<!--                    </div>-->
<!--                </form>-->
<!--            </div>-->
<!--            <div class="modal-footer">-->
<!--                <button type="button" class="btn btn-default" data-dismiss="modal">Zamknij</button>-->
<!--                <button type="button" class="btn btn-primary" id="generateReport">Generuj</button>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

                             <div class="modal fade" id="GEN_RAP" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                                 <div class="modal-dialog modal-dialog-centered" role="document">
                                    <div class="modal-content">
                                         <div class="modal-header">
                                             <span class="modal-title" id="exampleModalLongTitle3"><strong>Wybierz zakres dat.</strong></span>
                                             <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                             </button>
                                         </div>
                                         <div class="modal-body">
                                                <form id="dateForm">
                                                    <div class="form-group">
                                                        <label for="data_start" class="control-label">Data początkowa:</label>
                                                        <input type="date" class="form-control" id="data_start" name="data_start" required>
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="data_stop" class="control-label">Data końcowa:</label>
                                                        <input type="date" class="form-control" id="data_stop" name="data_stop" required>
                                                    </div>
                                                </form>
                                         </div>
                                         <div class="modal-footer" style="background-color: #eeeeee;">
                                             <button type="button" class="btn btn-default" data-dismiss="modal">&nbsp;&nbsp;Zamknij&nbsp;&nbsp;</button>
                                             <button type="button" class="btn btn-primary" id="generateReport">Generuj</button>
                                         </div>
                                    </div>
                                 </div>
                             </div>




                </div>

{% endblock %}


{% block script %}

$(document).ready(function() {
    // Pobierz aktualną datę
    const now = new Date();
    const currentYear = now.getFullYear();

    // Pierwszy dzień bieżącego roku
    const firstDayOfYear = new Date(currentYear, 0, 2); // Styczeń (miesiące liczone od 0)
    firstDayOfYear.setHours(0, 0, 0, 0); // Ustawienie godziny na początek dnia

    // Aktualna data (dzisiaj)
    const today = new Date();
    today.setHours(0, 0, 0, 0); // Ustawienie godziny na początek dnia

    // Ustaw wartości domyślne pól
    $('#data_start').val(firstDayOfYear.toISOString().split('T')[0]);
    $('#data_stop').val(today.toISOString().split('T')[0]);

    // Obsługa przycisku "Generuj"
    $('#generateReport').on('click', function() {
        const dataStart = $('#data_start').val();
        const dataStop = $('#data_stop').val();

        if (dataStart && dataStop) {
            // Zamknij modal
            $('#GEN_RAP').modal('hide');

            // Przekierowanie do wygenerowanego URL
            const url = `/TIMBER_WH/mag1/dre/texport/${dataStart}/${dataStop}/`;
            window.location.href = url;
        } else {
            alert('Proszę wypełnić oba pola dat.');
        }
    });
});





{% endblock %}



{% block about %}
                                 <tr><td class="text-right" width="300">
                                     <br>Wersja:
                                     <br>Ostatnia modyfikacja:<br>
                                     <br>Firma:
                                     <br>Autor:
                                     <br>Email:
                                     <br>Tel. kom.:<br>
                                     <br>
                                 </td><td>
                                     {% for ab in about %}
                                        <br>{{ ab.WERSJA }}
                                        <br>{{ ab.MODYFIKACJA }}
                                        <br>
                                        <br>{{ ab.FIRMA }}
                                        <br>{{ ab.AUTOR }}
                                     {% endfor %}
                                     <br><a href="mailto:biuro@edatabit.pl">biuro@edatabit.pl</a>
                                     <br>+48 791-648-417<br>
                                 </td></tr>
{% endblock %}
